{"paragraphs":[{"text":"%md\n\n# Percentage of owners who rent more than one property.","user":"anonymous","dateUpdated":"2020-01-11T16:45:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Percentage of owners who rent more than one property.</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1578758752206_1654126643","id":"20161121-215556_1513433460","dateCreated":"2020-01-11T16:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3916","dateFinished":"2020-01-11T16:45:36+0000","dateStarted":"2020-01-11T16:45:36+0000"},{"text":"%pyspark\n\nfrom decimal import *\n\n#df = spark.read.csv(\"/data/listings.csv\",header = \"true\")\npandas_df = pd.read_csv(\"/data/listings.csv\")\n\npandas_df = pandas_df.replace({r'\\\\n': ''}, regex=True)\n\ndf = sqlContext.createDataFrame(pandas_df.astype(str))\n\ntotal=df.select(df.host_name,df.calculated_host_listings_count).distinct().orderBy('host_name').count()\n\n\nd_hn=df.select(df.host_name,df.calculated_host_listings_count).filter(df.calculated_host_listings_count > 1).distinct().orderBy('host_name')\nd_hn_c = d_hn.count() \np = round((Decimal(d_hn_c) / Decimal(total))*100,2)\nprint(d_hn_c)\nprint(total)\nprint(p)\n","user":"anonymous","dateUpdated":"2020-01-11T17:00:32+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"703\n2128\n33.04\n"}]},"apps":[],"jobName":"paragraph_1578758752206_-605618326","id":"20161121-212329_269221065","dateCreated":"2020-01-11T16:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3917","dateFinished":"2020-01-11T17:00:25+0000","dateStarted":"2020-01-11T17:00:18+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=133","http://172.17.0.3:4040/jobs/job?id=134","http://172.17.0.3:4040/jobs/job?id=135","http://172.17.0.3:4040/jobs/job?id=136"],"interpreterSettingId":"spark"}}},{"text":"%md\n\n# Histogram of number of rentals reviewed over time (based on last_review) in month granularity.","user":"anonymous","dateUpdated":"2020-01-11T16:45:43+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Histogram of number of rentals reviewed over time (based on last_review) in month granularity.</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1578758752207_-1347286280","id":"20200110-164826_175142356","dateCreated":"2020-01-11T16:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3918","dateFinished":"2020-01-11T16:45:43+0000","dateStarted":"2020-01-11T16:45:43+0000"},{"text":"%pyspark\n\n\ndf.createOrReplaceTempView(\"listings\")\n\n\n\n","user":"anonymous","dateUpdated":"2020-01-11T16:45:43+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578758752207_1163118747","id":"20161121-212653_1761768042","dateCreated":"2020-01-11T16:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3919","dateFinished":"2020-01-11T16:45:43+0000","dateStarted":"2020-01-11T16:45:43+0000"},{"text":"%sql\n\nSELECT CONCAT(YEAR(last_review), \"-\" ,MONTH(last_review)) AS YearMonth, SUM(number_of_reviews )\n  FROM listings\n  Where last_review >= '2013-10-21' AND last_review != 'nan'\n GROUP BY YearMonth\n Order BY YearMonth","user":"anonymous","dateUpdated":"2020-01-11T17:03:36+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":5,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":292.016,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"YearMonth":"string","sum(CAST(number_of_reviews AS DOUBLE))":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"YearMonth","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"sum(CAST(number_of_reviews AS DOUBLE))","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"YearMonth\tsum(CAST(number_of_reviews AS DOUBLE))\n2013-10\t1.0\n2014-10\t1.0\n2014-12\t19.0\n2014-2\t1.0\n2014-3\t1.0\n2014-6\t2.0\n2014-7\t8.0\n2015-1\t75.0\n2015-10\t39.0\n2015-11\t28.0\n2015-12\t26.0\n2015-3\t35.0\n2015-5\t6.0\n2015-6\t7.0\n2015-7\t11.0\n2015-8\t42.0\n2015-9\t19.0\n2016-1\t55.0\n2016-10\t144.0\n2016-11\t77.0\n2016-12\t134.0\n2016-2\t60.0\n2016-3\t53.0\n2016-4\t75.0\n2016-5\t151.0\n2016-6\t79.0\n2016-7\t123.0\n2016-8\t155.0\n2016-9\t130.0\n2017-1\t152.0\n2017-10\t103.0\n2017-11\t172.0\n2017-12\t396.0\n2017-2\t193.0\n2017-3\t122.0\n2017-4\t108.0\n2017-5\t138.0\n2017-6\t223.0\n2017-7\t369.0\n2017-8\t202.0\n2017-9\t198.0\n2018-1\t376.0\n2018-10\t461.0\n2018-11\t628.0\n2018-12\t965.0\n2018-2\t216.0\n2018-3\t202.0\n2018-4\t396.0\n2018-5\t442.0\n2018-6\t278.0\n2018-7\t526.0\n2018-8\t746.0\n2018-9\t629.0\n2019-1\t1447.0\n2019-2\t1451.0\n2019-3\t1576.0\n2019-4\t1552.0\n2019-5\t2989.0\n2019-6\t5847.0\n2019-7\t16825.0\n2019-8\t59783.0\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1578758752207_-1901573989","id":"20200110-143129_137393741","dateCreated":"2020-01-11T16:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3920","dateFinished":"2020-01-11T16:54:11+0000","dateStarted":"2020-01-11T16:54:11+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=132"],"interpreterSettingId":"spark"}}},{"text":"%md\n\n# Number of rentals that are available all 365 days of the year for each neighbourhood, that are in the neighbourhood which have top 5 average rental prices.","user":"anonymous","dateUpdated":"2020-01-11T16:45:44+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Number of rentals that are available all 365 days of the year for each neighbourhood, that are in the neighbourhood which have top 5 average rental prices.</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1578758752207_-1487450464","id":"20200110-164729_83090414","dateCreated":"2020-01-11T16:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3921","dateFinished":"2020-01-11T16:45:44+0000","dateStarted":"2020-01-11T16:45:44+0000"},{"text":"%pyspark\n\nimport shutil\nshutil.rmtree('TopFiveNeighbourhoods.parquet', ignore_errors=True)\n\ndf = spark.sql(\"select  neighbourhood,avg(price) AS Price  from listings        Group by neighbourhood    order by price    Limit 5\")\n\ndf.write.save(\"TopFiveNeighbourhoods.parquet\")\n\nparquetFile = spark.read.load(\"TopFiveNeighbourhoods.parquet\")\n\ndf = spark.sql(\"SELECT count(name) As NumberofListings FROM listings where availability_365 = '365' AND neighbourhood in (select neighbourhood from parquet.`TopFiveNeighbourhoods.parquet`)\")\n\ndf.show()\n","user":"anonymous","dateUpdated":"2020-01-11T16:45:44+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+\n|NumberofListings|\n+----------------+\n|              22|\n+----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1578758752208_-1038131936","id":"20200110-160949_2089973104","dateCreated":"2020-01-11T16:05:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3922","dateFinished":"2020-01-11T16:45:45+0000","dateStarted":"2020-01-11T16:45:44+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=124","http://172.17.0.3:4040/jobs/job?id=125","http://172.17.0.3:4040/jobs/job?id=126","http://172.17.0.3:4040/jobs/job?id=127","http://172.17.0.3:4040/jobs/job?id=128"],"interpreterSettingId":"spark"}}}],"name":"AirBnB Listings","id":"2EZZZ9R8F","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}